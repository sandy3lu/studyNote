
# MAC
![](pic/MAC.png)

# HMAC
![](pic/HMAC.png)

# RSA
![](pic/RSA.png)

## 例子
![](pic/RSA-1.png)

## 公钥
![](pic/RSA-2.png)

#Diffie-Hellman密钥交换算法
DH算法的安全性依赖于离散对数问题的计算难度。
![](pic/DH.png)

## 中间人攻击
![](pic/中间人攻击.png)

预防：
- 使用共享对称密钥对DH密钥交换过程加密。
- 使用公钥对DH密钥交换过程加密。
- 使用私钥对DH密钥交换过程中的值签名

# ECC
## 椭圆曲线
![](pic/椭圆曲线.png)

## 加法（椭圆曲线唯一需要的数学运算）
P1+P2 = P3
几何上解释：做一条直线通过P1和P2，直线与椭圆曲线在另一处相交，交点围绕x轴做对称映射，得到P3.
## 离散
![](pic/椭圆曲线-1.png)

例子：
![](pic/椭圆曲线-2.png)
## 椭圆曲线上的模P加法
![](pic/椭圆曲线-3.png)


# 秘密共享
![](pic/秘密共享.png)

## 密钥托管
![](pic/密钥托管.png)


# 国密算法
# SM4
SM4是分组算法，分组长度128bit，密钥长度128bit（16字节）。加密算法与密钥扩展算法都采用32轮非线性迭代结构。数据解密和加密的算法结构相同，只是轮密钥使用顺序相反，解密轮密钥是加密轮密钥的逆序。

# SM3
对长度l比特的消息（l<2^64），SM3杂凑算法经过填充、迭代压缩和输出选裁，生成256比特的杂凑值。
## 填充
填充后的数据是512bit的倍数，l+1+k = 448(mod 512)，再填加64比特的l的二进制表示
![](pic/SM3.png)

# SM2

涉及到3类辅助函数：密码杂凑函数、密钥派生函数、随机数发生器。这3类辅助函数的强弱直接影响算法的安全性。

## 椭圆曲线系统参数
![](pic/SM2.png)

SM2的参数
![](pic/SM2-6.png)

## 密钥对
![](pic/SM2-1.png)
私钥32字节，公钥32+32字节

## 用户其他信息
![](pic/SM2-2.png)

## 数字签名

签名：
![](pic/SM2-3.png)
Hv()选用SM3摘要算法，输出是256bit的杂凑值，记为H256()。

验证：
![](pic/SM2-4.png)
![](pic/SM2-5.png)

IDA：
16字节*8 = 128bit = 0x0080
![](pic/SM2-7.png)

## 加解密
### 加密
![](pic/SM2-8.png)

C1的长度是1+32+32字节(C1 = 04||x1||y1)，C3的长度是SM3摘要的长度，256bit，C2的长度是klen 比特。


其中KDF
![](pic/SM2-9.png)

### 解密
![](pic/SM2-10.png)

## 密钥交换协议

![](pic/SM2-11.png)
![](pic/SM2-12.png)
![](pic/SM2-13.png)

# SM9
标识密码（Identity-Based Cryptography），用户的私钥由密钥生成中心KGC根据主密钥和用户标识计算得出，用户的公钥由用户标识唯一确定，用户不需要通过第三方来保证其公钥的真实性。
- 主密钥：主私钥由KGC秘密保存，主公钥公开。KGC用主私钥和用户标识生成用户的私钥
- 签名系统的主密钥与加密系统的主密钥不同。